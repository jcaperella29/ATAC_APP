





# ğŸ”¬ ATAC-seq Peak Annotation & Enrichment Viewer

This interactive **R Shiny** app allows you to upload **MACS2 `.narrowPeak`** files, annotate peaks using **ChIPseeker**, and visualize functional enrichment with **enrichR** â€” all without touching a single line of R.

ğŸ’¡ Built with love in R, glowy CSS, and battle-tested on real-world ATAC-seq data.

---

## ğŸ“š Table of Contents

- [ğŸ“¸ App Screenshots](#-app-screenshots)
- [ğŸš€ Features](#-features)
- [ğŸ§ª Sample Data](#-sample-data)
- [ğŸ“¦ Requirements](#-requirements-if-running-outside-docker)
- [ğŸ§ª How to Run the App](#-how-to-run-the-app)
- [ğŸ›ï¸ How to Use the App](#-how-to-use-the-app)
- [ğŸ“Š Tab Overview](#-tab-overview)
- [ğŸ› ï¸ Developer Notes](#-developer-notes)
- [ğŸ“ Folder Structure](#-folder-structure)
- [ğŸ‘¨â€ğŸ”¬ Citation / Credit](#-citation--credit)
- [ğŸ§  FAQ](#-faq)

---

## ğŸ“¸ App Screenshots

### ğŸ§¬ Peak Annotation Pie Chart
![Pie Chart](screenshots/Annotation_pie_chart.png)

### ğŸ“‘ Enrichment Table
![Enrichment Table](screenshots/enrichment_table.png)

### ğŸ“Š Peak Annotation Table
![Annotation Table](screenshots/annotation_table.png)

### ğŸ”¬ Enrichment Bar Plot
![Bar Plot](screenshots/enrichment_bar_plot.png)

---

## ğŸš€ Features

- ğŸ“‚ Upload MACS2 `.narrowPeak` files
- ğŸ§¬ Annotate peaks via `ChIPseeker`
- ğŸ“Š Visualize annotation (tables, pie charts)
- ğŸ§  Run functional enrichment (GO, KEGG, Reactome via `enrichR`)
- ğŸ“¦ Fully containerized via Docker (no Shiny Server needed)
- ğŸ–¥ï¸ HPC/local compatible â€” cloud optional

---

## ğŸ§ª Sample Data

A sample **ATAC-seq narrowPeak file** is provided for testing purposes.

- ğŸ“ Location: `sample_data/ENCFF002CUU.bed`
- ğŸ§¬ Source: ENCODE Project â€“ GM12878 cell line (hg19 assembly)  
  [ENCFF002CUU â€“ IDR-thresholded peaks](https://www.encodeproject.org/files/ENCFF002CUU/)

This file can be used to test the appâ€™s upload and visualization functions without needing to preprocess your own data.

---

## ğŸ“¦ Requirements (if running outside Docker)

Install the required R packages manually:

```r
install.packages(c(
  "shiny", "shinyjs", "plotly", "DT", "enrichR", "clusterProfiler"
))
if (!requireNamespace("BiocManager", quietly=TRUE)) install.packages("BiocManager")
BiocManager::install(c(
  "ChIPseeker", "GenomicRanges", "TxDb.Hsapiens.UCSC.hg38.knownGene",
  "org.Hs.eg.db"
))

ğŸ§ª How to Run the App
ğŸ” Option 1: Local (with Docker)

in Bash
git clone https://github.com/your-user/ATAC_APP.git
cd ATAC_APP
bash run.sh

Then open in your browser:
http://localhost:8787

ğŸ’» Option 2: Local (RStudio)
r

# From inside R
setwd("path/to/ATAC_APP")
library(shiny)
runApp(".")

ğŸ§  Option 3: Singularity (for HPC clusters)
If you're on an HPC system using Singularity or Apptainer:
ğŸ“¦ Build the container

in Bash:
singularity build atac-shiny.sif Singularity.def
ğŸš€ Run the app:
singularity run --bind $(pwd):/mnt atac-shiny.sif

ğŸŒ Access in browser:

# On remote HPC, port forward:
ssh -L 8080:localhost:8080 youruser@cluster
# Then open:
http://localhost:8080

ğŸ›ï¸ How to Use the App
Upload a MACS2 .narrowPeak file

Click "Upload"

Load your peaks

Run Peak Annotation

Click "Run Peak Annotation"

Annotates peaks with ChIPseeker

Run Enrichment

Select DB: GO / KEGG / Reactome

Click "Run Enrichment Analysis"

ğŸ“Š Tab Overview
Tab	Description
Peak Annotation Table	Searchable table of annotated peaks with CSV download
Annotation Pie Chart	Visual pie chart of peak distribution
Enrichment Table	Table of enriched terms (CSV exportable)
Enrichment Bar Plot	Top 10 enriched terms visualized with plotly
README	Embedded usage guide inside app

ğŸ› ï¸ Developer Notes
ğŸ”’ Internal Error Logging
All errors are logged to error_log.txt.
For long-term use, schedule email_log.R to:

Email logs to dev at midnight

Archive old logs into /logs/

ğŸ“ Folder Structure

ATAC_APP/
â”œâ”€â”€ app.R                  # Main app
â”œâ”€â”€ email_log.R           # Internal dev monitoring (cron/timer)
â”œâ”€â”€ www/
â”‚   â””â”€â”€ fairy_tail.css    # Glowy anime-themed UI
â”œâ”€â”€ error_log.txt         # Autogenerated
â”œâ”€â”€ logs/                 # Log archives (optional)
â”œâ”€â”€ run.sh                # Docker launcher script
â”œâ”€â”€ Dockerfile            # Full containerized environment
â”œâ”€â”€ sample_data/
â”‚   â””â”€â”€  ENCFF002CUU.bed # Example input file
â””â”€â”€ README.md             # You're here
 Citation / Credit
If you use this in a paper or lab project, a shoutout or link back is appreciated ğŸ™
MIT License. Fork away.

ğŸ§  FAQ
Q: Why isnâ€™t this deployed on the cloud?
A: This app uses Bioconductor packages (e.g., Rhtslib, ChIPseeker, TxDb) that require native compilation and large genomic data libraries. These do not play well with serverless environments like Cloud Run, but work great on Docker/HPC setups.

Q: Can I run this on an HPC?
âœ… Yes. This app is fully portable via Docker or Singularity.

Built by scientists, for scientists.
ğŸ§¬ğŸ–¥ï¸ Make ATAC analysis suck less.







